      SUBROUTINE GAMMA(KFILDO,K,ND1,YDATA,THRESH,NPROB,B,F)
C
C        OCTOBER 1999   RUDACK TDL   MOS-2000
C
C        DATA SET USE 
C            KFILDO - DEFAULT UNIT NUMBER FOR OUTPUT (PRINT) FILE.
C                     (OUTPUT) 
C
C         PURPOSE: 
C                 TO EVALUATE THE FUNCTION 'GAMMA'.
C
C         DATA SET USE 
C            KFILDO - DEFAULT UNIT NUMBER FOR OUTPUT (PRINT) FILE.
C                     (INPUT) 
C 
C         VARIABLES 
C             KFILDO = DEFAULT UNIT NUMBER FOR OUTPUT (PRINT) FILE.
C                      (INPUT) 
C                  K = STATION COUNTER (K=1,ND1). (INPUT)
C                ND1 = NUMBER OF TOTAL STATIONS (K=1,ND1). (INPUT)
C         YDATA(K,J) = ADJUSTED PROBABILITIES (K=1,ND1) (J=1,6). (INPUT)
C          THRESH(L) = PRECIPITATION AMOUNTS FOR WHICH PROBABILITIES EXIST. 
C                      (L=1,5 FOR 6-HR PROJECTION) (L=1,6 FOR 12-HR & 24-HR
C                      PROJECTION).  (INPUT)
C              NPROB = NUMBER OF ADJUSTED PROBABILITIES USED TO DETERMINE THE
C                      WEIBULL DISTRIBUTION.  (INPUT)
C                  B = INTERVAL ENDPOINTS.  (INPUT)
C                  F = VALUE RETURNED FROM SUBROUTINE 'GAMMA'. (OUTPUT)
C
C          NONSYSTEM SUBROUTINES CALLED 
C                   NONE
C 
      DIMENSION YDATA(ND1,6),THRESH(6)
      DOUBLE PRECISION B2,TERM1,TERM2,TERM3,TERM4,LNX,LNP
      DOUBLE PRECISION XB,X2B      
C
C        FIND INTERVAL IN WHICH ROOT (BETA) IS KNOWN TO EXIST.
C
      B2=2.0*B
      TERM1=0.0D0
      TERM2=0.0D0
      TERM3=0.0D0
      TERM4=0.0D0    
C
      DO 100 J=1,NPROB
C
         XB=(THRESH(J))**B
         X2B=(THRESH(J)**B2)
         LNX=LOG(THRESH(J))
         LNP=LOG(YDATA(K,J))
         TERM1=TERM1+X2B
         TERM2=TERM2+(LNP*XB*LNX)
         TERM3=TERM3+(LNP*XB)
         TERM4=TERM4+(X2B*LNX)
C
 100  CONTINUE      
C
      F=(TERM1*TERM2)-(TERM3*TERM4)
C
      RETURN
      END
    
    
 
