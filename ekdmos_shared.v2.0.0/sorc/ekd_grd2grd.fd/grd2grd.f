      PROGRAM GRD2GRD
C
C$$$  MAIN PROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C MAIN PROGRAM: MDL_GRD2GRD
C   PRGMMR: MALONEY          ORG: OST22       DATE: 2005-10-31
C
C ABSTRACT: THIS PROGRAM COPIES A GRIDDED TDLPACK FILE ONTO
C           ANOTHER GRID WITH DIFFERENT CHARACTERISTICS.
C
C PROGRAM HISTORY LOG:
C 2002-07-01  RUDACK  
C   05-10-31  MALONEY  - CONVERTED TO NCEP STANDARDS
C   07-09-10  COSGROVE   CHANGED ND2,ND3 TO COVER AK GMOS GRID.
C   07-09-20  COSGROVE   INCREASED ND4 FROM 100 TO HANDLE ALL THE 
C                        ELEMENTS IN AK GMOS
C
C        DATA SET USE
C        INPUT FILES:
C         FORT.KFILDI - UNIT NUMBER OF DEFAULT INPUT FILE.
C                       THIS IS PROBABLY SPECIFIED FOR THE SYSTEM
C                       BEING USED.  SET IN DATA STATEMENT.
C
C        OUTPUT FILES:  (INCLUDING WORK FILES)
C         FORT.KFILDO - UNIT NUMBER OF DEFAULT OUTPUT (PRINT) FILE.
C                       THIS IS PROBABLY SPECIFIED FOR THE SYSTEM
C                       BEING USED.  SET IN DATA STATEMENT.
C
C        VARIABLES
C             ND2 = ND2*ND3 IS THE MAXIMUM SIZE OF THE GRID THAT CAN
C                   BE DEALT WITH.
C             ND3 = ND2*ND3 IS THE MAXIMUM SIZE OF THE GRID THAT CAN
C                   BE DEALT WITH.  SEE ND2.  BECAUSE ND5 = ND2X3,
C                   AND ND5 MAY NEED TO BE LARGER THAN ND2X3, ND2
C                   OR ND3 MAY NEED TO BE SET LARGER THAN NECESSARY.
C                   SINCE THE INDIVIDUAL VALUES OF ND2 AND ND3 ARE
C                   NOT USED, THIS IS OK.
C             ND4 = THE MAXIMUM NUMBER OF VARIABLES IN A RUN OF U365.
C             ND5 = DIMENSION OF IPACK( ), IWORK( ), AND DATA( ).
C                   THESE ARE GENERAL PURPOSE ARRAYS, SOMETIMES USED
C                   FOR GRIDS.  TO AVIOD ERRORS IN CERTAIN ROUTINES,
C                   AND TO AVOID CONFUSION, ND5 SHOULD BE SET EQUAL TO
C                   ND2X3.  ALSO, BECAUSE IPACK( ) AND IWORK( ) ARE 
C                   USED AS WORK ARRAYS IN RDSNAM, ND5 SHOULD NOT BE
C                   LT ND12.
C             ND6 = MAXIMUM NUMBER OF SEQUENTIAL FILES THAT CAN BE DEALT 
C                   WITH.  
C             ND7 = DIMENSION OF IS0( ), IS1( ), IS2( ), AND IS4( ).
C                   SHOULD BE GE 54.
C             ND8 = MAXIMUM NUMBER OF DATES THAT CAN BE DEALT WITH.
C            ND11 = MAXIMUM NUMBER OF INPUT GRID COMBINATIONS IN A RUN OF 
C                   U365.
C
C       SUBPROGRAMS CALLED:  U365, W3TAGB, W3TAGE
C          UNIQUE: - U365
C          LIBRARY:
C            W3LIB - W3TAGB, W3TAGE
C
C        EXIT STATES:
C          COND =    0 - SUCCESSFUL RUN
C
C REMARKS:  NONE
C
C ATTRIBUTES:
C   LANGUAGE:  FORTRAN 90 (xlf90 compiler)
C   MACHINE:  IBM SP
C
C$$$
C
      PARAMETER(L3264B=32)
      PARAMETER(L3264W=64/L3264B)
C
C**** PARAMETER(ND2=137,
C****1          ND3=81)
C**** PARAMETER(ND2=300,
C****1          ND3=200)
C**** PARAMETER(ND2=500,
C****1          ND3=400)
C**** PARAMETER(ND2=485,
C****1          ND3=370)
C**** PARAMETER (ND2=965,
C****1           ND3=730)
C***AVN GRID***************
C**** PARAMETER(ND2=1100,
C****1          ND3=650)
C**** PARAMETER(ND2=1090,
C****1          ND3=650)
C****************************
C**** PARAMETER(ND2=1925,
C**** 1         ND3=1455)
C**** PARAMETER(ND2=2180,
C**** 1         ND3=1290)
C**** PARAMETER(ND2=3850,
C**** 1         ND3=2900)
C**** NDFD CONUS GRID
C**** PARAMETER(ND2=1073,
C****1          ND3=689)
C**** GMOS AK GRID
      PARAMETER(ND2=2145,
     1          ND3=1597)
C
      PARAMETER(ND2X3=ND2*ND3)
      PARAMETER(ND4=4500)
      PARAMETER(ND5=ND2X3)
      PARAMETER(ND6=30)
      PARAMETER(ND7=54)
      PARAMETER(ND8=200)
      PARAMETER(ND11=20)
C
      CHARACTER*12 UNITS(ND4)
      CHARACTER*32 PLAIN(ND4)
      CHARACTER*60 NAMIN(ND6)
C
      DIMENSION ID(4,ND4),IDPARS(15,ND4),THRESH(ND4),JD(4,ND4),
     1          JP(3,ND4),ISCALD(ND4),SMULT(ND4),SADD(ND4),
     2          ORIGIN(ND4),CINT(ND4)
      DIMENSION IPLAIN(L3264W,4,ND4)
      DIMENSION KFILIN(ND6)
      DIMENSION IS0(ND7),IS1(ND7),IS2(ND7),IS4(ND7)
      DIMENSION MDATE(ND8),NWORK(ND8)
      DIMENSION NGRIDC(6,ND11)
C
      EQUIVALENCE(PLAIN,IPLAIN)
C
      DATA KFILDI/5/,
     1     KFILDO/6/
      DATA PLAIN/ND4*' '/ 
C
      CALL W3TAGB('MDL_GRD2GRD',2000,0258,0065,'W/OST22')
      CALL TIMPR(KFILDO,KFILDO,'START U365          ')
CCC   OPEN(UNIT=KFILDI,FILE='U365.CN',STATUS='OLD',IOSTAT=IOS,ERR=900)
C
      CALL U365(KFILDI,KFILDO,KFILIN,ND2X3,
     1          ND4,ND5,ND6,ND7,ND8,ND11,
     2          ID,IDPARS,THRESH,JD,JP,ISCALD,
     3          SMULT,SADD,ORIGIN,CINT,UNITS,
     4          NGRIDC,PLAIN,IPLAIN,L3264B,L3264W,
     5          NAMIN,IS0,IS1,IS2,IS4,MDATE,NWORK)
C
      CALL TIMPR(KFILDO,KFILDO,'END U365            ')
      CALL W3TAGE('MDL_GRD2GRD')
      STOP    
C
C  900  CALL IERX(KFILDO,KFILDO,IOS,'DRU365','900 ')
C       STOP 900
C
      END
