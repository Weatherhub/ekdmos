      PROGRAM RA2GRIB2
C
C$$$  MAIN PROGRAM DOCUMENTATION BLOCK  ***
C
C MAIN PROGRAM: RA2GRIB2
C   PRGMMR: RUDACK           ORG: W/OST24     DATE: 2004-11-11
C
C ABSTRACT:  DRIVER FOR PROGRAM U135.  SEE U135 COMMENTS OR PROGRAM
C   WRITEUP FOR VARIABLE DEFINITIONS.  AN ATTEMPT HAS BEEN
C   MADE TO INCLUDE ALL INFORMATION IN THIS DRIVER THAT
C   THE USER OF U135 MIGHT HAVE TO CHANGE. 
C
C PROGRAM HISTORY LOG:
C   04-11-11  RUDACK
C   05-03-16  MALONEY ADDED NCEP DOCBLOCK. ADDED CALLS TO W3TAGB
C                     AND W3TAGE. CHANGED THE VALUE OF KFILDO FROM
C                     12 TO 6.  RENAMED RA2GRIB2.
C   06-02-14  RLC     INCREASED IPDSTMPLEN FROM 30 TO 36 TO ALLOW
C                     FOR PROPER USE OF PDT 4.9.
C   07-09-11  RLC     INCREASED ND5 TO HANDLE THE AK GMOS GRID
C   11-03-29  FAN     INCREASED ND5 TO HANDLE THE 2.5KM CONUS GMOS GRID
C   11-09-01  TLH     ADDED ISCT2LEN, DECREASED ND10,ND12 FROM 1000,1000
C                     TO 10,200 TO ALLOW FOR LOCAL USE/SECTION 2
C   15-05-27  SDS     INCREASED ND5 TO HANDLE THE 2.5KM CONUS GMOS GRID
C                     WITH NORTHERN EXPANSION 
C
C
C        DATA SET USE
C        INPUT FILES:
C         FORT.KFILDI - UNIT NUMBER OF DEFAULT INPUT FILE.
C                       THIS IS PROBABLY SPECIFIED FOR THE SYSTEM
C                       BEING USED.  SET IN DATA STATEMENT.
C
C        OUTPUT FILES:  (INCLUDING WORK FILES)
C         FORT.KFILDO - UNIT NUMBER OF DEFAULT OUTPUT (PRINT) FILE.
C                       THIS IS PROBABLY SPECIFIED FOR THE SYSTEM
C                       BEING USED.  SET IN DATA STATEMENT.
C
C        VARIABLES
C                 ND4 = MAXIMUM NUMBER OF CONSTANT VARIABLES IN THE BITMAP
C                       VARIABLE LIST.  (MAXIMUM ALLOWED IS ONE)
C                 ND5 = DIMENSION OF IPACK( ), IWORK( ) AND DATA( ).
C                       NOTE THAT ND5 MUST BE GE NX*NY. 
C                 ND7 = DIMENSION OF IS0( ), IS1( ), IS2( ), AND IS4( ).
C                       SHOULD BE GE 54.
C                 ND8 = MAXIMUM NUMBER OF DATES THAT CAN BE DEALT WITH.
C                ND10 = MAXIMUM NUMBER OF FIELDS ALLOWED IN ANY ONE MESSAGE.
C                ND11 = MAXIMUM NUMBER OF OUTPUT GRID ENTRIES DEFINED IN
C                       THE GRID DEFINITION FILE CORRESPONDING TO SECTION 3.
C                ND12 = MAXIMUM NUMBER OF GROUPS (OR MESSAGES) THAT CAN
C                       BE PROCESSED IN ONE RUN OF U135.
C              LCGRIB = MAXIMUM LENGTH (BYTES) OF GRIB2 MESSAGE (STORED IN 
C                       CHARACTER ARRAY CGRIB( ).)
C            ISCT2LEN = MAXIMUM DIMENSION OF FSCT2( ).  LOCAL USE
C                       SECTION OF THE GRIB2 MESSAGE (SECTION 2).
C                       IF OPTIONAL LOCAL USE SECTION IS NOT TO BE USED,
C                       ISCT2LEN CAN BE SET VERY LOW (I.E., 1).
C          IGDSTMPLEN = MAXIMUM DIMENSION OF IGDSTMPL( ).  GRID DEFINITION
C                       SECTION OF THE GRIB2 MESSAGE (SECTION 3).
C          IPDSTMPLEN = MAXIMUM DIMENSION OF IPDSTMPL( ).  PRODUCT 
C                       DEFINITION SECTION OF THE GRIB2 MESSAGE (SECTION 4).
C          IDRSTMPLEN = MAXIMUM DIMENSION OF IDRSTMPL( ).  DATA REPRESENTATION
C                       SECTION OF THE GRIB2 MESSAGE (SECTION 5).
C             IDEFNUM = (USED IF IGDS(3).NE.0) THE NUMBER OF ENTRIES IN ARRAY
C                       IDEFLIST( ).  I.E., THE NUMBER OF ROWS (COLUMNS) FOR
C                       WHICH OPTIONAL GRID POINTS ARE DEFINED.  
C            NUMCOORD = NUMBER OF VALUES IN ARRAY COORDLIST( ). 
C
C       SUBPROGRAMS CALLED:  U135, W3TAGB, W3TAGE
C          UNIQUE: - U135
C          LIBRARY:
C            W3LIB - W3TAGB, W3TAGE
C
C        EXIT STATES:
C          COND =    0 - SUCCESSFUL RUN
C
C REMARKS:  NONE
C
C ATTRIBUTES:
C   LANGUAGE:  FORTRAN 90 (xlf90 compiler)
C   MACHINE:  IBM SP
C
C$$$
C
      PARAMETER(L3264B=32)
C
      PARAMETER(ND4=30)
      PARAMETER(ND5=3425565)
C      PARAMETER(ND5=1825000)
      PARAMETER(ND7=54)
      PARAMETER(ND8=100)
      PARAMETER(ND10=10)
      PARAMETER(ND11=20)
      PARAMETER(ND12=200)
C
      PARAMETER(LCGRIB=6000000)
      PARAMETER(ISCT2LEN=200000)
      PARAMETER(IGDSTMPLEN=26)
      PARAMETER(IPDSTMPLEN=36)
      PARAMETER(IDRSTMPLEN=19)
      PARAMETER(IDEFNUM=0)
      PARAMETER(NUMCOORD=0)
C
      LOGICAL*1 BMAP(ND5)
C
      DIMENSION IWORK(ND5),FLD(ND5),BMAPDATA(ND5)
      DIMENSION IS0(ND7),IS1(ND7),IS2(ND7),IS4(ND7)
C
      DATA KFILDI/5/,
     1     KFILDO/6/
C
      CALL W3TAGB('RA2GRIB2',2000,0258,0065,'W/OST22')
      CALL TIMPR(KFILDO,KFILDO,'START U135          ')
CCC   OPEN(UNIT=KFILDI,FILE='U135.CN',STATUS='OLD',IOSTAT=IOS,ERR=900)
C
      CALL U135(KFILDI,KFILDO,IWORK,FLD,
     1          BMAPDATA,BMAP,IS0,IS1,IS2,IS4,
     2          ND4,ND5,ND7,ND8,ND10,ND11,ND12,
     3          LCGRIB,ISCT2LEN,IGDSTMPLEN,IPDSTMPLEN,
     4          IDRSTMPLEN,IDEFNUM,NUMCOORD,
     5          L3264B)
C
      CALL TIMPR(KFILDO,KFILDO,'END U135            ')
      CALL W3TAGE('RA2GRIB2')
      STOP
C
C900  CALL IERX(KFILDO,KFILDO,IOS,'U135','900 ')
C     STOP 900
C
      END
