      SUBROUTINE RDWXCN(KFILDO,KFILWX,THRPHS,THRQPF,THRTRW,THRSVR,
     1                  IPHSBC,PHSTMP,NSVRLOC,NX,NY,IER)
C 
C        MARCH     2012   HUNTEMANN  MDL   MOS-2000 
C                                          ADAPTED FROM RDV155
C        MARCH     2013   HUNTEMANN  MDL   ADDED IMPLICIT NONE
C
C        PURPOSE 
C            TO READ A WEATHER GRID CONTROL FILE AND ASSOCIATED INFORMATION 
C            FROM A FILE ON UNIT KFILWX.  
C
C        DATA SET USE 
C            KFILDO - DEFAULT UNIT NUMBER FOR OUTPUT (PRINT) FILE.  (OUTPUT) 
C            KFILWX - UNIT NUMBER FROM WHICH TO READ WEATHER GIRID INFORMATION.
C                     IT IS ASSUMED FILE HAS BEEN OPENED.  (INPUT) 
C 
C        VARIABLES 
C              KFILDO = DEFAULT UNIT NUMBER FOR OUTPUT (PRINT) FILE. (INPUT) 
C              KFILWX = UNIT NUMBER FROM WHICH TO READ WEATHER GRID CONTROL FILE.
C                       IT IS ASSUMED FILE HAS BEEN OPENED.  (INPUT)
C                       (OUTPUT)
C           THRPHS(I) = REAL VECTOR OF LENGTH (4) CONTAINING THE PHASE
C                       THRESHOLDS, EXPRESSED IN PERCENT, OF THE FOUR 
C                       PERMITTED CATEGORICAL PROBABILITY FORECASTS 
C                       (OUTPUT).  ELEMENTS WITHIN THRPHS MUST BE 
C                       BETWEEN 0 AND 100 PERCENT, INCLUSIVE, AND BE 
C                       MONOTONICALLY INCREASING. (I=1,4)
C           THRQPF(I) = REAL VECTOR OF LENGTH (2) CONTAINING THE QPF6 
C                       THRESHOLDS, EXPRESSED IN PERCENT, OF THE TWO 
C                       PERMITTED CATEGORICAL PROBABILITY FORECASTS. 
C                       ELEMENTS WITHIN THRQPF MUST BE BETWEEN 
C                       0 AND 100 PERCENT, INCLUSIVE, AND BE 
C                       MONOTONICALLY INCREASING. (OUTPUT)  (I=1,2)
C           THRTRW(I) = REAL VECTOR OF LENGTH (4) CONTAINING THE THUNDER
C                       THRESHOLDS, EXPRESSED IN PERCENT, OF THE FOUR 
C                       PERMITTED CATEGORICAL PROBABILITY FORECASTS 
C                       (OUTPUT).  ELEMENTS WITHIN THRTRW MUST BE 
C                       BETWEEN 0 AND 100 PERCENT, INCLUSIVE, AND BE 
C                       MONOTONICALLY INCREASING. (I=1,4)
C           THRSVR(I) = REAL VECTOR OF LENGTH (4) CONTAINING THE SEVERE 
C                       THRESHOLDS, EXPRESSED IN PERCENT, OF THE FOUR 
C                       PERMITTED CATEGORICAL PROBABILITY FORECASTS 
C                       (OUTPUT).  ELEMENTS WITHIN THRSVR MUST BE 
C                       BETWEEN 0 AND 100 PERCENT, INCLUSIVE, AND BE 
C                       MONOTONICALLY INCREASING. (I=1,4)
C              PHSTMP = PRECIPITATION PHASE CUTOVER TEMPERATURE
C                       THRESHOLD TO LIQUID.  IF THE MOS FORECAST
C                       TEMPERATURE IS AT OR ABOVE PHSTMP, THE 
C                       PRECIPITATION PHASE IS INITIALIZED TO 
C                       LIQUID. (OUTPUT)
C              IPHSBC = FLAG FOR USING CONDITIONAL PRECIPITATION TYPE
C                       BEST CATEGORY THRESHOLDS:
C                       1 = USE THRESHOLDS
C                       ELSE = DON'T USE THRESHOLDS
C                       (OUTPUT) 
C             NSVRLOC = FLAG TO DETERMINE ORDER OF ASCII WEATHER SUBKEYS.
C                       1 = SEVERE ALWAYS FIRST
C                       2 = SCT,NUM,DEF SEVERE ALWAYS FIRST
C                       3 = SHOW LESS SEVERE AT LATER PROJECTIONS
C                       (OUTPUT) 
C                  NX = NUMBER OF GRIDPOINTS IN X DIRECTION. (OUTPUT)
C                  NY = NUMBER OF GRIDPOINTS IN Y DIRECTION. (OUTPUT)
C               ISTOP = INCREASED BY 1 WHENEVER AN ERROR IS ENCOUNTERED.
C                       (INPUT-OUTPUT)
C                 IER = STATUS RETURN.  (OUTPUT)
C                        0 = GOOD RETURN.
C                       40 = ERROR READING VARIABLE LIST.
C                       41 = DIMENSION ND4 ABOUT TO BE EXCEEDED.
C        1         2         3         4         5         6         7 X
C 
C        NONSYSTEM SUBROUTINES CALLED 
C            NONE
C
      IMPLICIT NONE
C
      CHARACTER*4 STATE
      REAL THRPHS(4),THRTRW(4),THRQPF(2),THRSVR(4),PHSTMP
      INTEGER KFILDO,KFILWX,IOSTAT,IPHSBC,NSVRLOC,NX,NY,J,IOS,IER
C
C        READ IN PARAMETERS FOR WEATHER GRID FROM AN 
C        EXTERNAL CONTROL FILE.
C
      STATE='100 '
      READ(KFILWX,105,IOSTAT=IOS,ERR=900)
     1    (THRPHS(J),J=1,4),(THRQPF(J),J=1,2),
     2    (THRTRW(J),J=1,4),(THRSVR(J),J=1,4),
     3    IPHSBC,PHSTMP,NSVRLOC,NX,NY
 105  FORMAT(4F6.1,/,2F6.1,/,4F6.1,/,4F6.1,/,I1,/,F6.1,/,I1,/,2I5)
C
 106  WRITE(KFILDO,1010)THRPHS,THRTRW,THRSVR,THRQPF,
     1      IPHSBC,PHSTMP,NSVRLOC,NX,NY
C
1010  FORMAT(/,'WEATHER GRID PARAMETERS AS READ BY RDWXCN',
     1 /,4X,'POTENTIAL INDEX THRESHOLDS',/,4X,18X,
     2 'SCHC   CHC  LKLY   DEF',
     3 /,4X,'   PRECIPITATION',4F6.1,
     4 /,4X,'   THUNDERSTORM ',4F6.1,
     5 /,4X,'   SEVERE TSTM  ',4F6.1,
     6 2/,4X,'PRECIPITATION INTENSITY THRESHOLDS (HEAVY, MODERATE):',
     7 /,4X,'   ',2F6.1,
     8 2/,4X,' IPHSBC',I6,/,4X,' PHSTMP',F6.1,/,4X,'NSVRLOC',I6,
     9 /,4X,'     NX',I6,/,4X,'     NY',I6)
C
      RETURN
C 
C        ERROR STOP BELOW IS FOR ERRORS OF CONTROL INFORMATION INPUT.
 900  CALL IERX(KFILDO,KFILDO,IOS,'RDWXCN',STATE)
      STOP 900
C
      END 
